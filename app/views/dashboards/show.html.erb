
<div class="card text-bg-dark banner-card mb-4">
  <%# Fundo: banner (Cloudinary) ou placeholder %>
  <% if @user.banner.attached? %>
    <%= cl_image_tag @user.banner.key,
          width: 1600, height: 300, crop: :fill, gravity: :auto,
          fetch_format: :auto, quality: :auto,
          class: "card-img banner-card__img",
          alt: "Banner de #{@user.name}" %>
  <% else %>
    <div class="card-img banner-card__placeholder"></div>
  <% end %>

  <%# Overlay: avatar no canto superior esquerdo %>
  <div class="card-img-overlay p-3 p-md-4">
    <div class="banner-card__avatar-wrap">
      <% if @user.avatar.attached? %>
        <%= cl_image_tag @user.avatar.key,
              width: 120, height: 120, crop: :fill, gravity: :face,
              fetch_format: :auto, quality: :auto,
              class: "rounded-circle shadow banner-card__avatar",
              alt: @user.name %>
      <% else %>
        <% initials = (@user.name.presence || @user.email).split.map { |s| s[0] }.join.first(2).upcase %>
        <div class="rounded-circle d-flex align-items-center justify-content-center banner-card__avatar-fallback shadow">
          <%= initials %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="container">
  <% if has_services? %>
    <h2 class="text-center">Serviços</h2>
    <div class="row">
      <% @services.each do |service| %>
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <div class="card-body">
              <h5 class="card-title"><%= service.name %></h5>
              <p class="card-text"><%= service.description %></p>
              <p class="card-text">
                <small class="text-muted">
                  <i class="bi bi-clock"></i>
                  <%= service.price_hour %> preço
                </small>
              </p>
              <p class="card-text">
                <small class="text-muted">
                  <i class="bi bi-person-circle"></i>
                  <%= service.user.email%>
                </small>
              </p>
              <p class="card-text">
                <small class="text-muted">
                  <i class="bi bi-calendar-event"></i>
                  <%#= service.user.schedules.first.start_at.strftime("%d/%m/%Y") %>
                </small>
              </p>
            </div>
          </div>
        </div>
          <% end %>
      </div>
    </div>

  <% end %>
  <% if current_user&.professional? %>
    <%= link_to 'Novo Serviço', new_service_path, class: "btn btn-warning" %>
  <% end %>
</div>
